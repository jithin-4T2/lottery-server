const express = require('express');

const app = express();
const PORT = process.env.PORT || 3000;

// --- MANUAL DATA STRUCTURE ---
const MANUAL_RESULTS = {
    "Today": { // KARUNYA LOTTERY NO.KR-720th (From KR-720.pdf)
        "drawName": "KARUNYA KR-720",
        "1st Prize": { prize: '1st Prize', amount: '₹10,000,000', type: 'full', numbers: ["KF 261432"] },
        "Consolation Prize": { prize: 'Consolation Prize', amount: '₹5,000', type: 'full', numbers: ["KA 261432", "KB 261432", "KC 261432", "KD 261432", "KE 261432", "KG 261432", "KH 261432", "KJ 261432", "KK 261432", "KL 261432", "KM 261432"]},
        "2nd Prize": { prize: '2nd Prize', amount: '₹2,500,000', type: 'full', numbers: ["KJ 816050"] },
        "3rd Prize": { prize: '3rd Prize', amount: '₹1,000,000', type: 'full', numbers: ["KL 178997"] },
        "4th Prize": { prize: '4th Prize', amount: '₹5,000', type: 'endsWith', numbers: ["0467", "0574", "0880", "1457", "1505", "1771", "1833", "2315", "3383", "5265", "5902", "6383", "6632", "6788", "6932", "7050", "7650", "7870", "9346", "9870"]},
        "5th Prize": { prize: '5th Prize', amount: '₹2,000', type: 'endsWith', numbers: ["0136", "3079", "5494", "6420", "6724", "9983"]},
        "6th Prize": { prize: '6th Prize', amount: '₹1,000', type: 'endsWith', numbers: ["0627", "0897", "1062", "1072", "1323", "1772", "1834", "2732", "2765", "2966", "3255", "3735", "4025", "4104", "4499", "4618", "4828", "4954", "5023", "5673", "5766", "6204", "6213", "6411", "6614", "7400", "9300", "9351", "9471", "9504"]},
        "7th Prize": { prize: '7th Prize', amount: '₹500', type: 'endsWith', numbers: ["0072", "0334", "0358", "0367", "0594", "0605", "0620", "0782", "0845", "1144", "1222", "1452", "1471", "1477", "1552", "1600", "1715", "1752", "1793", "2053", "2355", "2420", "2521", "2525", "2586", "2719", "2823", "3303", "3849", "3910", "3952", "4122", "4285", "4561", "4708", "4900", "5028", "5071", "5229", "5758", "5791", "5890", "6016", "6208", "6307", "6394", "6403", "6685", "6798", "6800", "6838", "6967", "7010", "7269", "7324", "7361", "7409", "7417", "7446", "7473", "8100", "8165", "8361", "8409", "8416", "8432", "8570", "8861", "8947", "8996", "9380", "9579", "9618", "9626", "9876", "9989"]},
        "8th Prize": { prize: '8th Prize', amount: '₹200', type: 'endsWith', numbers: ["0073", "0113", "0123", "0126", "0974", "1025", "1044", "1154", "1400", "1719", "1899", "2152", "2170", "2346", "2365", "2421", "2551", "2634", "2722", "2801", "2856", "2976", "2985", "3009", "3042", "3071", "3145", "3164", "3253", "3278", "3506", "3857", "3907", "4139", "4333", "4344", "4536", "4743", "5098", "5121", "5131", "5280", "5318", "5464", "5553", "5618", "5639", "5882", "6007", "6018", "6040", "6226", "6313", "6721", "6986", "7164", "7336", "7373", "7485", "7553", "7577", "7716", "7884", "7965", "8013", "8048", "8269", "8370", "8387", "8556", "8608", "8627", "8774", "8945", "8979", "8988", "9076", "9103", "9174", "9198", "9248", "9339", "9569", "9704", "9756", "9760", "9779", "9787", "9855", "9867", "9881", "9912"]}
    },
    "AUG 22": { // SUVARNA KERALAM LOTTERY NO.SK-16th (From SK-16.pdf)
        "drawName": "SUVARNA SK-16",
        "1st Prize": { prize: '1st Prize', amount: '₹10,000,000', type: 'full', numbers: ["RV 209957"] },
        "Consolation Prize": { prize: 'Consolation Prize', amount: '₹5,000', type: 'full', numbers: ["RN 209957", "RO 209957", "RP 209957", "RR 209957", "RS 209957", "RT 209957", "RU 209957", "RW 209957", "RX 209957", "RY 209957", "RZ 209957"]},
        "2nd Prize": { prize: '2nd Prize', amount: '₹3,000,000', type: 'full', numbers: ["RX 141148"] },
        "3rd Prize": { prize: '3rd Prize', amount: '₹500,000', type: 'full', numbers: ["RS 201072"] },
        "4th Prize": { prize: '4th Prize', amount: '₹5,000', type: 'endsWith', numbers: ["0352", "0566", "0832", "2383", "2580", "2590", "2797", "3155", "3779", "3929", "4802", "5295", "5859", "5955", "6326", "7039", "7636", "7669", "8945", "9184"]},
        "5th Prize": { prize: '5th Prize', amount: '₹2,000', type: 'endsWith', numbers: ["0110", "0376", "0764", "4371", "8114", "9935"]},
        "6th Prize": { prize: '6th Prize', amount: '₹1,000', type: 'endsWith', numbers: ["0077", "0300", "0520", "0774", "1314", "1845", "2261", "2433", "2676", "3071", "3096", "4056", "4468", "4729", "4812", "4937", "5110", "5738", "6118", "6212", "6358", "6525", "6832", "7167", "7180", "8060", "8077", "8451", "9754", "9958"]},
        "7th Prize": { prize: '7th Prize', amount: '₹500', type: 'endsWith', numbers: ["0150", "0170", "0297", "0448", "0461", "0600", "0609", "0630", "0713", "0826", "0846", "1142", "1173", "1338", "1422", "1460", "1501", "1546", "1563", "1687", "1766", "1841", "1849", "2233", "2253", "2272", "2284", "2522", "2529", "2540", "2552", "2602", "3081", "3198", "3372", "3465", "3656", "3765", "3775", "3861", "4035", "4208", "4363", "4405", "4544", "4646", "4959", "5089", "5132", "5378", "5458", "5480", "5910", "6026", "6192", "6414", "6789", "6954", "7036", "7065", "7354", "7442", "7457", "7462", "7606", "7886", "8075", "8230", "8266", "8427", "8887", "9025", "9105", "9239", "9418", "9628"]},
        "8th Prize": { prize: '8th Prize', amount: '₹200', type: 'endsWith', numbers: ["0054", "0092", "0209", "0429", "0945", "0950", "0973", "1061", "1090", "1202", "1468", "1530", "1544", "1721", "1773", "1896", "2025", "2080", "2144", "2165", "2243", "2263", "2315", "2322", "2332", "2409", "2505", "2679", "2769", "2827", "2846", "2855", "3028", "3549", "3596", "3652", "3671", "3738", "3939", "4085", "4185", "4380", "4416", "4591", "4824", "4831", "4841", "5051", "5181", "5269", "5687", "5929", "6032", "6302", "6350", "6454", "6469", "6487", "6681", "6800", "6838", "6930", "7084", "7101", "7125", "7127", "7196", "7337", "7459", "7498", "7607", "7689", "7739", "7812", "8066", "8112", "8252", "8305", "8378", "8426", "8438", "8517", "8860", "9095", "9132", "9295", "9350", "9517", "9610", "9776", "9825", "9827"]}
    },
    "AUG 21": { // KARUNYA PLUS LOTTERY NO.KN-586th (From KN-586.pdf)
        "drawName": "KARUNYA PLUS KN-586",
        "1st Prize": { prize: '1st Prize', amount: '₹10,000,000', type: 'full', numbers: ["PS 763057"] },
        "Consolation Prize": { prize: 'Consolation Prize', amount: '₹5,000', type: 'full', numbers: ["PN 763057", "PO 763057", "PP 763057", "PR 763057", "PT 763057", "PU 763057", "PV 763057", "PW 763057", "PX 763057", "PY 763057", "PZ 763057"]},
        "2nd Prize": { prize: '2nd Prize', amount: '₹3,000,000', type: 'full', numbers: ["PT 354012"] },
        "3rd Prize": { prize: '3rd Prize', amount: '₹500,000', type: 'full', numbers: ["PU 475795"] },
        "4th Prize": { prize: '4th Prize', amount: '₹5,000', type: 'endsWith', numbers: ["0017", "0074", "0510", "1412", "1514", "2122", "2155", "2448", "2841", "3767", "3947", "5803", "5894", "5937", "5942", "5966", "6516", "6690", "7478", "9490"]},
        "5th Prize": { prize: '5th Prize', amount: '₹2,000', type: 'endsWith', numbers: ["0822", "5076", "5520", "6020", "8578", "9935"]},
        "6th Prize": { prize: '6th Prize', amount: '₹1,000', type: 'endsWith', numbers: ["0035", "0285", "0627", "0790", "1085", "1506", "2510", "2735", "2736", "3106", "3624", "3749", "3800", "4083", "4532", "5231", "5351", "5830", "6028", "6054", "6810", "7397", "7799", "7910", "8049", "8204", "8591", "8901", "9316", "9755"]},
        "7th Prize": { prize: '7th Prize', amount: '₹500', type: 'endsWith', numbers: ["0000", "0114", "0239", "0297", "0436", "0769", "0938", "1053", "1054", "1174", "1443", "1571", "1587", "1650", "1809", "1843", "1903", "2336", "2525", "2857", "3050", "3112", "3114", "3229", "3787", "3849", "4034", "4138", "4554", "4639", "4661", "4782", "4880", "5111", "5377", "5412", "5440", "5523", "5810", "5811", "5831", "6000", "6302", "6352", "6399", "6425", "6456", "6474", "6646", "6722", "6867", "6897", "7056", "7302", "7359", "7452", "7513", "7569", "7643", "7652", "7716", "8001", "8057", "8549", "8658", "8989", "9013", "9026", "9123", "9140", "9317", "9344", "9410", "9512", "9857", "9963"]},
        "8th Prize": { prize: '8th Prize', amount: '₹200', type: 'endsWith', numbers: ["0122", "0174", "0593", "0674", "0729", "0866", "1047", "1070", "1228", "1343", "1553", "1890", "1925", "2031", "2152", "2359", "2360", "2507", "2578", "2806", "2847", "2947", "3065", "3085", "3264", "3459", "3527", "3604", "3692", "4167", "4178", "4360", "4419", "4422", "4426", "4576", "4695", "4761", "4774", "4807", "4820", "5026", "5476", "5712", "5785", "5835", "5873", "5954", "5994", "5995", "6182", "6268", "6321", "6432", "6525", "6683", "6731", "7242", "7272", "7415", "7690", "7756", "8053", "8054", "8163", "8211", "8339", "8360", "8504", "8554", "8718", "8751", "8761", "8840", "8982", "9254", "9314", "9359", "9417", "9436", "9677", "9804", "9805", "9810"]}
    },
    "AUG 20": { // DHANALEKSHMI LOTTERY NO.DL-14th (From DL-14.pdf)
        "drawName": "DHANALEKSHMI DL-14",
        "1st Prize": { prize: '1st Prize', amount: '₹10,000,000', type: 'full', numbers: ["DT 613976"] },
        "Consolation Prize": { prize: 'Consolation Prize', amount: '₹5,000', type: 'full', numbers: ["DN 613976", "DO 613976", "DP 613976", "DR 613976", "DS 613976", "DU 613976", "DV 613976", "DW 613976", "DX 613976", "DY 613976", "DZ 613976"]},
        "2nd Prize": { prize: '2nd Prize', amount: '₹3,000,000', type: 'full', numbers: ["DW 800036"] },
        "3rd Prize": { prize: '3rd Prize', amount: '₹500,000', type: 'full', numbers: ["DO 955514"] },
        "4th Prize": { prize: '4th Prize', amount: '₹5,000', type: 'endsWith', numbers: ["0290", "0604", "0740", "1533", "1581", "1678", "1886", "2156", "2600", "4666", "5392", "5432", "5800", "6014", "7238", "8154", "8229", "9048", "9112", "9422"]},
        "5th Prize": { prize: '5th Prize', amount: '₹2,000', type: 'endsWith', numbers: ["1530", "1599", "5153", "9030", "9315", "9641"]},
        "6th Prize": { prize: '6th Prize', amount: '₹1,000', type: 'endsWith', numbers: ["0320", "0560", "1052", "1070", "1847", "2829", "2902", "2966", "3144", "3467", "3818", "3866", "3976", "4205", "4345", "5982", "6099", "6147", "6578", "6654", "7007", "7076", "7287", "7294", "7844", "8042", "8494", "9119", "9270", "9766"]},
        "7th Prize": { prize: '7th Prize', amount: '₹500', type: 'endsWith', numbers: ["0244", "0452", "0600", "0614", "0651", "0728", "0960", "1066", "1303", "1520", "1551", "1606", "1635", "1726", "1754", "1863", "2224", "2265", "2268", "2327", "2461", "2662", "2956", "3215", "3280", "3609", "3685", "3815", "3994", "4104", "4105", "4211", "4387", "4527", "4606", "4608", "4716", "4778", "4822", "4848", "4994", "5029", "5112", "5319", "5336", "5406", "5553", "5955", "6022", "6076", "6666", "6855", "7078", "7559", "7613", "7626", "7689", "7709", "7843", "7975", "8031", "8066", "8348", "8409", "8619", "8792", "8903", "8919", "9204", "9218", "9295", "9336", "9437", "9449", "9692", "9693"]},
        "8th Prize": { prize: '8th Prize', amount: '₹200', type: 'endsWith', numbers: ["0095", "0099", "0223", "0417", "0688", "0696", "0744", "0820", "0840", "0905", "0933", "1027", "1290", "1313", "1345", "1693", "1768", "1918", "1930", "1976", "2104", "2111", "2203", "2318", "2367", "2488", "2520", "2524", "2683", "2707", "2797", "2806", "2922", "3002", "3402", "3438", "3442", "3458", "3538", "3552", "3571", "3839", "3937", "3966", "3971", "3999", "4109", "4328", "4729", "4761", "4904", "4951", "5024", "5296", "5349", "5494", "5499", "5539", "5671", "5742", "5893", "5946", "5998", "6144", "6198", "6473", "6724", "6737", "6740", "6822", "6886", "6902", "6978", "7244", "7327", "7464", "7773", "7999", "8009", "8023", "8201", "8405", "8509", "8519", "8690", "8810", "8818", "9171", "9184", "9300", "9485", "9533", "9807", "9846", "9851", "9926"]}
    },
    "AUG 19": { // STHREE-SAKTHI LOTTERY NO.SS-481st (From SS-481.pdf)
        "drawName": "STHREE-SAKTHI SS-481",
        "1st Prize": { prize: '1st Prize', amount: '₹10,000,000', type: 'full', numbers: ["SP 470148"] },
        "Consolation Prize": { prize: 'Consolation Prize', amount: '₹5,000', type: 'full', numbers: ["SN 470148", "SO 470148", "SR 470148", "SS 470148", "ST 470148", "SU 470148", "SV 470148", "SW 470148", "SX 470148", "SY 470148", "SZ 470148"]},
        "2nd Prize": { prize: '2nd Prize', amount: '₹3,000,000', type: 'full', numbers: ["ST 823246"] },
        "3rd Prize": { prize: '3rd Prize', amount: '₹500,000', type: 'full', numbers: ["SN 817719"] },
        "4th Prize": { prize: '4th Prize', amount: '₹5,000', type: 'endsWith', numbers: ["0588", "1093", "1308", "1425", "1806", "3816", "4086", "5122", "5240", "5598", "5957", "6611", "7656", "7796", "7909", "8490", "8562", "9244", "9736", "9940"]},
        "5th Prize": { prize: '5th Prize', amount: '₹2,000', type: 'endsWith', numbers: ["0071", "4339", "5235", "6225", "9066", "9435"]},
        "6th Prize": { prize: '6th Prize', amount: '₹1,000', type: 'endsWith', numbers: ["0238", "0510", "1238", "1859", "2558", "3238", "3522", "3552", "3588", "3626", "4428", "5315", "5516", "5525", "5545", "5671", "5931", "6451", "6657", "6854", "7021", "7262", "7577", "7726", "8466", "8689", "8888", "9478", "9528", "9737"]},
        "7th Prize": { prize: '7th Prize', amount: '₹500', type: 'endsWith', numbers: ["0082", "0219", "0332", "0793", "1217", "1245", "1312", "1335", "1484", "1541", "1630", "1796", "1939", "2067", "2235", "2501", "2575", "2579", "2650", "2715", "2752", "2938", "3269", "3514", "3662", "3747", "3834", "3870", "3907", "3984", "4142", "4767", "4809", "4827", "4846", "4937", "4954", "5015", "5087", "5152", "5188", "5196", "5595", "6159", "6212", "6239", "6267", "6418", "6627", "6906", "7174", "7181", "7475", "7565", "7576", "7747", "7850", "7960", "7985", "8066", "8185", "8377", "8740", "8764", "8792", "8926", "9264", "9369", "9431", "9456", "9715", "9730", "9776", "9803", "9833", "9860"]},
        "8th Prize": { prize: '8th Prize', amount: '₹200', type: 'endsWith', numbers: ["0115", "0492", "0577", "0777", "0780", "0864", "0870", "1029", "1111", "1336", "1481", "1510", "1600", "1677", "1683", "1908", "2047", "2086", "2231", "2329", "2389", "2504", "2743", "3123", "3212", "3334", "3595", "3616", "3884", "3893", "3962", "4010", "4140", "4164", "4281", "4488", "4575", "4835", "4950", "4967", "5023", "5064", "5112", "5395", "5499", "5844", "6026", "6036", "6054", "6264", "6432", "6494", "6513", "6862", "6961", "7011", "7207", "7279", "7284", "7448", "7710", "7830", "7937", "7968", "8013", "8157", "8301", "8322", "8328", "8461", "8508", "8581", "8703", "8868", "8919", "8943", "8993", "8994", "9024", "9198", "9267", "9296", "9320", "9582", "9657", "9658", "9664", "9802", "9890", "9990"]}
    },
    "AUG 18": { // BHAGYATHARA LOTTERY NO.BT-16th (From BT-16.pdf)
        "drawName": "BHAGYATHARA BT-16",
        "1st Prize": { prize: '1st Prize', amount: '₹10,000,000', type: 'full', numbers: ["BV 219851"] },
        "Consolation Prize": { prize: 'Consolation Prize', amount: '₹5,000', type: 'full', numbers: ["BN 219851", "BO 219851", "BP 219851", "BR 219851", "BS 219851", "BT 219851", "BU 219851", "BW 219851", "BX 219851", "BY 219851", "BZ 219851"]},
        "2nd Prize": { prize: '2nd Prize', amount: '₹3,000,000', type: 'full', numbers: ["BV 769240"] },
        "3rd Prize": { prize: '3rd Prize', amount: '₹500,000', type: 'full', numbers: ["BV 107697"] },
        "4th Prize": { prize: '4th Prize', amount: '₹5,000', type: 'endsWith', numbers: ["0520", "0898", "1832", "1890", "2009", "3416", "4390", "4820", "5366", "5551", "6165", "6583", "7471", "7506", "7899", "7952", "9197", "9258", "9651", "9747"]},
        "5th Prize": { prize: '5th Prize', amount: '₹2,000', type: 'endsWith', numbers: ["3295", "4061", "6929", "7431", "8024", "8075"]},
        "6th Prize": { prize: '6th Prize', amount: '₹1,000', type: 'endsWith', numbers: ["0021", "0218", "0245", "0466", "0871", "1002", "1172", "1344", "1955", "1959", "2908", "3113", "3626", "3686", "3820", "4372", "4404", "4517", "4963", "5005", "5548", "5823", "6394", "6676", "6692", "7208", "8740", "9928", "9964", "9995"]},
        "7th Prize": { prize: '7th Prize', amount: '₹500', type: 'endsWith', numbers: ["0016", "0027", "0442", "0449", "0536", "0654", "0657", "0840", "0967", "1256", "1701", "1722", "1856", "2057", "2063", "2279", "2499", "2531", "2619", "2697", "2703", "2794", "2857", "3153", "3234", "3430", "3548", "3619", "3657", "3798", "3937", "4037", "4564", "5098", "5105", "5164", "5268", "5275", "5291", "5385", "5606", "6018", "6150", "6363", "6399", "6411", "6643", "6673", "6789", "6794", "6828", "6859", "6908", "7124", "7636", "7664", "7701", "7768", "7770", "7776", "7897", "7982", "8147", "8345", "8489", "8654", "8697", "8826", "8895", "9073", "9213", "9245", "9458", "9511", "9591", "9771"]},
        "8th Prize": { prize: '8th Prize', amount: '₹200', type: 'endsWith', numbers: ["0137", "0142", "0316", "0380", "0556", "0580", "0605", "0669", "0753", "1389", "1404", "1443", "1470", "1521", "1724", "1779", "1798", "2066", "2074", "2298", "2304", "2444", "2501", "2653", "2998", "3071", "3212", "3276", "3420", "3568", "3616", "3734", "3802", "3900", "3957", "4112", "4214", "4249", "4280", "4356", "4548", "4637", "4724", "4794", "4862", "4923", "5036", "5062", "5554", "5594", "5611", "5624", "5758", "5905", "5921", "5992", "6022", "6262", "6336", "6358", "6370", "6475", "6602", "6772", "6810", "6862", "6878", "6884", "6965", "7677", "7735", "7759", "7779", "8038", "8071", "8255", "8498", "8512", "8522", "8525", "8632", "8646", "8924", "8952", "9027", "9240", "9334", "9392", "9624", "9672", "9749", "9831", "9853", "9981"]}
    },
    "AUG 17": { // SAMRUDHI LOTTERY NO.SM-16th (From SM-16.pdf)
        "drawName": "SAMRUDHI SM-16",
        "1st Prize": { prize: '1st Prize', amount: '₹10,000,000', type: 'full', numbers: ["MU 819960"] },
        "Consolation Prize": { prize: 'Consolation Prize', amount: '₹5,000', type: 'full', numbers: ["MN 819960", "MO 819960", "MP 819960", "MR 819960", "MS 819960", "MT 819960", "MV 819960", "MW 819960", "MX 819960", "MY 819960", "MZ 819960"]},
        "2nd Prize": { prize: '2nd Prize', amount: '₹2,500,000', type: 'full', numbers: ["MR 813336"] },
        "3rd Prize": { prize: '3rd Prize', amount: '₹500,000', type: 'full', numbers: ["MN 444621"] },
        "4th Prize": { prize: '4th Prize', amount: '₹5,000', type: 'endsWith', numbers: ["0404", "0503", "2017", "2027", "3193", "3416", "3508", "4482", "4949", "5690", "7435", "7537", "7989", "8030", "8264", "8275", "8365", "8890", "9737", "9976"]},
        "5th Prize": { prize: '5th Prize', amount: '₹2,000', type: 'endsWith', numbers: ["0472", "2700", "3990", "6649", "6697", "9041"]},
        "6th Prize": { prize: '6th Prize', amount: '₹1,000', type: 'endsWith', numbers: ["0322", "1197", "1425", "1872", "1882", "2005", "2217", "2921", "3309", "4247", "4376", "5400", "5443", "5445", "5814", "5921", "5927", "6458", "6666", "6706", "6984", "7362", "7371", "7779", "7964", "8064", "8931", "9616", "9818", "9863"]},
        "7th Prize": { prize: '7th Prize', amount: '₹500', type: 'endsWith', numbers: ["0085", "0105", "0351", "0436", "0692", "0791", "0963", "1199", "1479", "1563", "1569", "1860", "1929", "2108", "2164", "2339", "2395", "2460", "2610", "2663", "2803", "2911", "2940", "3075", "3097", "3131", "3240", "3530", "3555", "3566", "3801", "3968", "3969", "4019", "4045", "4056", "4067", "4326", "4501", "4555", "4590", "4642", "4781", "4901", "5322", "5331", "5856", "6008", "6011", "6319", "6494", "6581", "6637", "7250", "7512", "7551", "7726", "8002", "8029", "8106", "8218", "8219", "8415", "8453", "8492", "8505", "8702", "8784", "8956", "8989", "9034", "9039", "9070", "9312", "9348", "9695"]},
        "8th Prize": { prize: '8th Prize', amount: '₹200', type: 'endsWith', numbers: ["0065", "0146", "0237", "0473", "0827", "0840", "0871", "0910", "0914", "0938", "1034", "1088", "1382", "1470", "1548", "1664", "1756", "1807", "1972", "2099", "2160", "2387", "2424", "2518", "2528", "2551", "2575", "2741", "2759", "2782", "2814", "3259", "3296", "3342", "3365", "3371", "3397", "3424", "3428", "3748", "3797", "3865", "3939", "4011", "4279", "4418", "4457", "4738", "4906", "4924", "4953", "5003", "5183", "5290", "5379", "5645", "5652", "6087", "6207", "6237", "6438", "6877", "7031", "7083", "7096", "7253", "7472", "7488", "7556", "7814", "7818", "7844", "7926", "7979", "7990", "8145", "8161", "8236", "8263", "8332", "8421", "8471", "8558", "8678", "8746", "8891", "9269", "9466", "9577", "9779", "9865", "9904"]}
    },
    "AUG 16": { // KARUNYA LOTTERY NO.KR-719th (From KR-719.pdf)
        "drawName": "KARUNYA KR-719",
        "1st Prize": { prize: '1st Prize', amount: '₹10,000,000', type: 'full', numbers: ["KZ 445643"] },
        "Consolation Prize": { prize: 'Consolation Prize', amount: '₹5,000', type: 'full', numbers: ["KN 445643", "KO 445643", "KP 445643", "KR 445643", "KS 445643", "KT 445643", "KU 445643", "KV 445643", "KW 445643", "KX 445643", "KY 445643"]},
        "2nd Prize": { prize: '2nd Prize', amount: '₹2,500,000', type: 'full', numbers: ["KU 786025"] },
        "3rd Prize": { prize: '3rd Prize', amount: '₹1,000,000', type: 'full', numbers: ["KW 820794"] },
        "4th Prize": { prize: '4th Prize', amount: '₹5,000', type: 'endsWith', numbers: ["0106", "0107", "1394", "1841", "2038", "2519", "2735", "2900", "3335", "3462", "6030", "6471", "7012", "7103", "7334", "7684", "7875", "8048", "8270", "9574"]},
        "5th Prize": { prize: '5th Prize', amount: '₹2,000', type: 'endsWith', numbers: ["0585", "4651", "5391", "8025", "9044", "9641"]},
        "6th Prize": { prize: '6th Prize', amount: '₹1,000', type: 'endsWith', numbers: ["0033", "1088", "1753", "1815", "1899", "2447", "2684", "3430", "3600", "3832", "4064", "4245", "4313", "4337", "4579", "5259", "5370", "5771", "5935", "6433", "7136", "7229", "7515", "7803", "7990", "8409", "8443", "9222", "9762", "9995"]},
        "7th Prize": { prize: '7th Prize', amount: '₹500', type: 'endsWith', numbers: ["0011", "0161", "0291", "0397", "0580", "0611", "0620", "0640", "1094", "1163", "1434", "1438", "1540", "1604", "1612", "1730", "2259", "2334", "2538", "2643", "2800", "2989", "3552", "3570", "3822", "3825", "3860", "3984", "4079", "4420", "4478", "4607", "4627", "4866", "4940", "5269", "5462", "5582", "5617", "5647", "5670", "5683", "6018", "6022", "6265", "6378", "6444", "6574", "6711", "6847", "7014", "7037", "7046", "7437", "7681", "7724", "7810", "7818", "7872", "7929", "8041", "8448", "8852", "8950", "9001", "9055", "9061", "9174", "9211", "9234", "9277", "9367", "9734", "9834", "9905", "9928"]},
        "8th Prize": { prize: '8th Prize', amount: '₹200', type: 'endsWith', numbers: ["0002", "0050", "0063", "0085", "0180", "0221", "0537", "0666", "0844", "1018", "1115", "1140", "1192", "1739", "1757", "1873", "1942", "1980", "2066", "2080", "2178", "2581", "2660", "2826", "3002", "3092", "3224", "3285", "3337", "3371", "3458", "3476", "3496", "3648", "3866", "3969", "4014", "4034", "4183", "4310", "4364", "4448", "4606", "4655", "4872", "4995", "5044", "5076", "5098", "5196", "5268", "5334", "5367", "5413", "5420", "5482", "5664", "5757", "6142", "6227", "6382", "6404", "6494", "6749", "7022", "7190", "7246", "7263", "7468", "7566", "7703", "7716", "7775", "7796", "7882", "8106", "8305", "8316", "8560", "8579", "8616", "8628", "8673", "8678", "8797", "8807", "8841", "9183", "9296", "9480", "9634", "9790"]}
    },
};

function getAllPrizesForDate(date) {
    const resultsForDate = MANUAL_RESULTS[date];
    if (!resultsForDate) return [];
    const allPrizes = [];
    for (const prizeName in resultsForDate) {
        if (prizeName === 'drawName') continue;
        const prizeInfo = resultsForDate[prizeName];
        prizeInfo.numbers.forEach(number => {
            allPrizes.push({
                number: number,
                prize: prizeInfo.prize,
                amount: prizeInfo.amount,
                type: prizeInfo.type,
            });
        });
    }
    return allPrizes;
}

// *** THIS IS THE NEW ENDPOINT THAT WAS MISSING ***
app.get('/get-available-dates', (req, res) => {
    const dates = Object.keys(MANUAL_RESULTS).map((dateKey, index) => {
        return {
            id: dateKey.replace(/\s/g, '-').toLowerCase() + `-${index}`,
            date: dateKey,
            drawName: MANUAL_RESULTS[dateKey].drawName
        };
    });
    res.json(dates);
});

app.get('/get-all-results', (req, res) => {
    const { date } = req.query;
    if (!date) {
        return res.status(400).json({ error: 'Date is required.' });
    }
    const allPrizes = getAllPrizesForDate(date);
    res.json(allPrizes);
});

app.get('/check-ticket', (req, res) => {
  const { ticket, date } = req.query;
  if (!ticket || !date) {
    return res.status(400).json({ error: 'Ticket number and date are required.' });
  }
  const winningPrizesForDate = getAllPrizesForDate(date);
  if (winningPrizesForDate.length === 0) {
      return res.json({ result: 'lose', reason: `No results found for date: ${date}` });
  }
  const sanitizedTicket = ticket.replace(/\s/g, '').toUpperCase();
  let winResult = null;
  const fullMatch = winningPrizesForDate.find(p => p.type === 'full' && p.number.replace(/\s/g, '') === sanitizedTicket);
  if (fullMatch) {
    winResult = { prize: fullMatch.prize, amount: fullMatch.amount };
  } else {
    if (sanitizedTicket.length >= 4) {
        const lastFourDigitsOfTicket = sanitizedTicket.slice(-4);
        const partialMatch = winningPrizesForDate.find(p => p.type === 'endsWith' && p.number === lastFourDigitsOfTicket);
        if (partialMatch) {
          winResult = { prize: partialMatch.prize, amount: partialMatch.amount };
        }
    }
  }
  if (winResult) {
      res.json({ result: 'win', details: winResult });
  } else {
      res.json({ result: 'lose' });
  }
});

app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
  console.log("Server is using MANUALLY entered data. PDF parsing is disabled.");
});